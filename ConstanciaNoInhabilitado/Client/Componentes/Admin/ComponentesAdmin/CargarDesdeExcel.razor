@page "/ConstanciaNoInhabilitado/Admin/CargarExcel"

@using ConstanciaNoInhabilitado.Client.Shared.Forms;
@using ConstanciaNoInhabilitado.Client.Componentes.Menu;
@using ConstanciaNoInhabilitado.Client.Shared.Partial.Dialogs;
@using MudBlazor
@using ConstanciaNoInhabilitado.Client.Auth;
@using Microsoft.AspNetCore.Authorization;
@using Microsoft.AspNetCore.Components.Authorization;
@using ConstanciaNoInhabilitado.Client.Shared.Partial.Cards;
@inject IDialogService dialogService
@inject AuthenticationStateProvider authenticationStateProvider;
@inject NavigationManager navigationManager;
@attribute [Authorize]


<MainFormHome>
    <ContentBreadcrumbs>
        <MudLink Href="ConstanciaNoInhabilitado/Default">
            <b>Inicio</b>
        </MudLink>
        <b>/</b>
        <MudLink Href="ConstanciaNoInhabilitado/Admin/Default">
            <b>Administración</b>
        </MudLink>
        <b>/</b>
        <b style="color:#A8113E;">
            Cargar desde Archivo
        </b>
    </ContentBreadcrumbs>
    <Main>
        <CardForm>
            <Content>
                <MudGrid Justify="Justify.Center">
                    <MudItem xs="11">
                        <MudLink OnClick="MostrarMensaje">
                            <p style="font-size: 1.3rem">
                                <MudIcon Icon="@Icons.Material.Filled.Flag" Style="color:#A8113E; font-size: 2rem"></MudIcon>
                                Ayuda
                            </p>
                        </MudLink>
                    </MudItem>
                    <MudItem xs="5">
                        <MudFileUpload T="IBrowserFile" FilesChanged="UploadFiles" Accept=".xlsx">
                            <ButtonTemplate>
                                <MudFab HtmlTag="label"
                                        Color="Color.Success"
                                        Icon="@Icons.Material.Filled.AttachFile"
                                        for="@context.Id"
                                        Label="Seleccionar Archivo" />
                            </ButtonTemplate>
                        </MudFileUpload>
                    </MudItem>                    
                    <MudItem xs="5">
                        <MudButton Variant="Variant.Filled" Color="Color.Secondary" Style="width:27vw;height:55px;">Cargar Archivo</MudButton>
                    </MudItem>
                    <MudItem xs="5">
                        @foreach (var file in files)
                        {
                            <p>@file.Name</p>
                        }
                    </MudItem>
                </MudGrid>
            </Content>
        </CardForm>
    </Main>
</MainFormHome>

@code {

    IList<IBrowserFile> files = new List<IBrowserFile>();
    private void UploadFiles(IBrowserFile file)
    {
        files.Add(file);
        //TODO upload the files to the server
    }

    public async Task MostrarMensaje()
    {
        var options = new DialogOptions()
            {
                FullWidth = true,
                MaxWidth = MaxWidth.Small,
                DisableBackdropClick = true,
                ClassBackground = "filterBackground",
                CloseButton = true
            };
        await dialogService.ShowAsync<ModalAyudaCargarExcel>("Simple Dialog", options);
    }
}